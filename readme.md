# AniReco üé¨  
**–ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –∞–Ω–∏–º–µ —Å —è–∑—ã–∫–æ–≤–æ–π –º–æ–¥–µ–ª—å—é**

---

## üöÄ –û –ø—Ä–æ–µ–∫—Ç–µ  
AniReco ‚Äî content-based —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞, –∏—Å–ø–æ–ª—å–∑—É—é—â–∞—è BERT –¥–ª—è –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è –æ–ø–∏—Å–∞–Ω–∏–π –∞–Ω–∏–º–µ –≤ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏.
–ú–æ–¥–µ–ª—å –æ–±—É—á–∞–µ—Ç—Å—è –Ω–∞ –ø–∞—Ä–∞—Ö –∞–Ω–∏–º–µ –∏ –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç –∏—Ö —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫—É—é –±–ª–∏–∑–æ—Å—Ç—å, –ø–æ—Å–ª–µ —á–µ–≥–æ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ —Ñ–æ—Ä–º–∏—Ä—É—é—Ç—Å—è —á–µ—Ä–µ–∑ k-NN –ø–æ–∏—Å–∫ –≤ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤.

---

## üîß –ü–æ—á–µ–º—É —ç—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –∏–º–µ–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ  
* –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —É–º–µ–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å end-to-end —Ä–µ—à–µ–Ω–∏–µ: –æ—Ç –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö ‚Üí —Ö—Ä–∞–Ω–µ–Ω–∏—è ‚Üí –æ–±—Ä–∞–±–æ—Ç–∫–∏ ‚Üí –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏ ‚Üí –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π.  
* –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏: –Ω–µ–π—Ä–æ–Ω–Ω—ã–µ —Å–µ—Ç–∏ (PyTorch), –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ/–±—ã—Å—Ç—Ä—ã–µ —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, `orjson`).  
* –î–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ä–µ–∞–ª—å–Ω—ã—Ö –≤–Ω–µ—à–Ω–∏—Ö API (Jikan API) –¥–ª—è –æ–±–æ–≥–∞—â–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö.  

---
## ‚ú® –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
```
üì• –ü–∞—Ä—Å–∏–Ω–≥ –¥–∞–Ω–Ω—ã—Ö –∞–Ω–∏–º–µ (MyAnimeList)
üßπ –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∏ –∞–≥—Ä–µ–≥–∞—Ü–∏—è –¥–∞—Ç–∞—Å–µ—Ç–æ–≤
üß† –û–±—É—á–µ–Ω–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω–æ–π –º–æ–¥–µ–ª–∏
üìä –ò–Ω—Ñ–µ—Ä–µ–Ω—Å –∏ –ø–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π
üê≥ –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞ —á–µ—Ä–µ–∑ Docker
```

## üìã –û—Å–Ω–æ–≤–Ω—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏  
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –Ω–∞ –æ—Å–Ω–æ–≤–µ –∂–∞–Ω—Ä–∞ –∏ –æ—Ç–∑—ã–≤–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.  
- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Jikan API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –ø–æ –∞–Ω–∏–º–µ.
- –ú–æ–¥–µ–ª—å –Ω–∞ PyTorch –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –ø–æ–Ω—Ä–∞–≤–∏—Ç—Å—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ –∞–Ω–∏–º–µ.  
- –£–¥–æ–±–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∑–∞–ø—É—Å–∫–∞ —Å –ø–æ–º–æ—â—å—é docker.  
- –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ —Å —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º –Ω–∞ –¥–∞–Ω–Ω—ã–µ (`data/`), –∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ (`src/`), —Å–∫—Ä–∏–ø—Ç—ã (`scripts/`), —á—Ç–æ –æ—Ç—Ä–∞–∂–∞–µ—Ç –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—É—é –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—é –∫–æ–¥–∞.
---

## üß∞ –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫  
- –Ø–∑—ã–∫: Python 3.11  
- –ú–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ: PyTorch  
- –†–∞–±–æ—Ç–∞ —Å API: requests  
- –°–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è: orjson
- –í–Ω–µ—à–Ω–∏–π API: Jikan API  
- –°—Ä–µ–¥–∞: Conda –∏–ª–∏ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ Python  
- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è (dockerfile)

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –º–æ–¥–µ–ª–∏  
üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –º–æ–¥–µ–ª–∏
1. **–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ**\
    * –¢–µ–∫—Å—Ç–æ–≤—ã–µ –æ–ø–∏—Å–∞–Ω–∏—è (synopsis) –ø–∞—Ä –∞–Ω–∏–º–µ.
    * _–¢–æ–∫–µ–Ω–∏–∑–∞—Ü–∏—è:_ BertTokenizer.
2. **–¢–µ–∫—Å—Ç–æ–≤—ã–π —ç–Ω–∫–æ–¥–µ—Ä**\
    * _–ú–æ–¥–µ–ª—å:_ bert-base-uncased (HuggingFace).
    * _–í—ã—Ö–æ–¥:_ pooler_output (—Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å 768).
3. **–ü—Ä–æ–µ–∫—Ü–∏–æ–Ω–Ω–∞—è –≥–æ–ª–æ–≤–∞ (MLP)**\
    * –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –≤–µ–∫—Ç–æ—Ä–∞ BERT –≤ –∫–æ–º–ø–∞–∫—Ç–Ω—ã–π —ç–º–±–µ–¥–¥–∏–Ω–≥ (256):
    * Dropout(0.3)
    * Linear(768 ‚Üí 512) + ReLU
    * Linear(512 ‚Üí 256)
    * BatchNorm1d
4. **–û–±—É—á–µ–Ω–∏–µ**\
    * _–ú–µ—Ç–æ–¥:_ Contrastive / Margin-based loss.
    * _–ú–µ—Ç—Ä–∏–∫–∞:_ Cosine Similarity –º–µ–∂–¥—É —ç–º–±–µ–¥–¥–∏–Ω–≥–∞–º–∏ –ø–∞—Ä—ã.
    * _–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:_ Fine-tuning BERT —Å –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω—ã–º —Ä–∞–∑–º–æ—Ä–∞–∂–∏–≤–∞–Ω–∏–µ–º —Å–ª–æ—ë–≤.
    * _–¶–µ–ª—å:_ –ú–∞–∫—Å–∏–º–∏–∑–∞—Ü–∏—è —Å—Ö–æ–¥—Å—Ç–≤–∞ –ø–æ—Ö–æ–∂–∏—Ö –∏ –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∞–Ω–∏–º–µ.
5. **–ò–Ω—Ñ–µ—Ä–µ–Ω—Å –∏ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏**\
    * _–í–µ–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏—è:_ –ü–µ—Ä–µ–≤–æ–¥ –≤—Å–µ—Ö –æ–ø–∏—Å–∞–Ω–∏–π –≤ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ (256).
    * _–ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è:_ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ FAISS –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞.
    * _–ü–æ–∏—Å–∫:_ k-NN –ø–æ–∏—Å–∫ –ø–æ –≤–µ–∫—Ç–æ—Ä—É –∑–∞–ø—Ä–æ—Å–∞ + —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –∂–∞–Ω—Ä–∞–º.
    * _–†–µ–∑—É–ª—å—Ç–∞—Ç:_ Top-N –Ω–∞–∏–±–æ–ª–µ–µ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π.
---

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫  
### –õ–æ–∫–∞–ª—å–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞  
```
git clone https://github.com/Sh1nroq/AniReco.git  
cd AniReco  
docker build -t anireco-app .
docker run -it anireco-app
```

---

## üóÇÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
```
AniReco/
‚îÇ   Dockerfile          # Docker-–æ–±—Ä–∞–∑ –ø—Ä–æ–µ–∫—Ç–∞
‚îÇ   readme.md           # –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
‚îÇ   requirements.txt    # –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ Python
‚îÇ
‚îú‚îÄ‚îÄ data/               # –¥–∞–Ω–Ω—ã–µ –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–±—É—á–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ raw/            # –∏—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
‚îÇ   ‚îú‚îÄ‚îÄ processed/      # –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –¥–∞—Ç–∞—Å–µ—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ embeddings/     # —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ –∏ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏
‚îÇ
‚îú‚îÄ‚îÄ scripts/            # –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ parser_mal.py   # –ø–∞—Ä—Å–µ—Ä –¥–∞–Ω–Ω—ã—Ö –∞–Ω–∏–º–µ
‚îÇ   ‚îî‚îÄ‚îÄ prepare_data.py # –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞—Ç–∞—Å–µ—Ç–∞
‚îÇ
‚îî‚îÄ‚îÄ src/                # –æ—Å–Ω–æ–≤–Ω–æ–π –∫–æ–¥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
    ‚îú‚îÄ‚îÄ model/          # –æ–±—É—á–µ–Ω–∏–µ –∏ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å –º–æ–¥–µ–ª–∏
    ‚îî‚îÄ‚îÄ utils/          # —É—Ç–∏–ª–∏—Ç—ã –∏ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
```
---

## üìö –õ–∏—Ü–µ–Ω–∑–∏—è

MIT License ¬© 2025
